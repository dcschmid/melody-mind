---
import Layout from "@layouts/Layout.astro";
import { Picture } from "astro:assets";
import { getLangFromUrl, useTranslations } from "@utils/i18n";
import LanguagePicker from "@components/LanguagePicker.astro";
import Headline from "@components/Headline.astro";
import Paragraph from "@components/Paragraph.astro";
import ButtonLink from "@components/ButtonLink.astro";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// Dynamische Weiterleitung basierend auf Browser-Sprache
if (Astro.request.method === "GET" && !Astro.params.lang) {
  return Astro.redirect(
    getRelativeLocaleUrl(Astro.preferredLocale || "de", "/"),
  );
}

const title = t("login.welcome");
const description = t("login.description");
const keywords = t("meta.keywords");
---

<Layout
  title={title}
  description={description}
  keywords={keywords}
  showHeader={false}
>
  <div class="max-w-4xl w-full mx-auto px-6 py-12 flex flex-col items-center text-center">
    <!-- Language picker with improved position for better visibility -->
    <div class="self-center mb-6">
      <LanguagePicker />
    </div>

    <!-- Logo with proper image optimization and accessibility -->
    <Picture
      class="w-full max-w-[320px] h-auto mx-auto mb-10 transition-transform duration-300 motion-safe:hover:scale-105"
      src="/melody-mind.png"
      width={480}
      height={480}
      formats={["avif", "webp"]}
      alt="Melody Mind Logo - Musikquiz App Logo"
      loading="eager"
    />

    <Headline level="h1" title={title} />
    
    <Paragraph>{description}</Paragraph>

    <div class="flex flex-col items-center gap-4 mt-6 w-full max-w-xs">
      <ButtonLink 
        href={`/${lang}/gamehome`}
        aria-label="Zum Spiel starten"
      >
        <span class="text-lg">Weiter</span>
      </ButtonLink>
    </div>
  </div>
</Layout>