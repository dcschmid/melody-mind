---
/**
 * @component LoginPage
 * @description Login Page for MelodyMind that displays the auth form in login mode.
 * The page is optimized according to WCAG AAA standards for maximum accessibility
 * and provides a seamless login experience with form validation and error handling.
 *
 * Features:
 * - High contrast text with 7:1 ratio for WCAG AAA compliance
 * - Proper focus indicators for keyboard navigation
 * - Screen reader announcements for form errors
 * - Responsive design for all device sizes
 * - Seamless page transitions with View Transitions API
 * - Performance optimized with prefetch hints
 */

export const prerender = true;

export async function getStaticPaths() {
  return [
    { params: { lang: "en" } },
    { params: { lang: "de" } },
    { params: { lang: "fr" } },
    { params: { lang: "es" } },
    { params: { lang: "it" } },
    { params: { lang: "pt" } },
    { params: { lang: "da" } },
    { params: { lang: "nl" } },
    { params: { lang: "sv" } },
    { params: { lang: "fi" } },
    { params: { lang: "ru" } },
    { params: { lang: "uk" } },
    { params: { lang: "jp" } },
    { params: { lang: "cn" } },
  ];
}

import AuthForm from "@components/auth/AuthForm.astro";
import { getLangFromUrl, useTranslations } from "@utils/i18n";
import Layout from "@layouts/Layout.astro";
import BackToHomeLink from "@components/Shared/BackToHomeLink.astro";
import Headline from "@components/Headline.astro";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang.toString());
const translations = {
  pageTitle: t("auth.login.title"),
  pageDescription: t("auth.login.description"),
  headingText: t("auth.login.heading"),
};
const { pageTitle, pageDescription, headingText } = translations;
---

<Layout title={pageTitle} description={pageDescription}>
  <BackToHomeLink lang={lang.toString()} />
  <Headline level="h1" id="login-heading" title={headingText} />
  <div class="auth-form-container" aria-live="polite" aria-labelledby="login-heading" role="region">
    <AuthForm initialMode="login" />
  </div>
</Layout>

<style lang="scss">
  /* ======================================
   * LOGIN PAGE STYLES - WCAG AAA 2.2 COMPLIANT
   * Using CSS variables from global.css only
   * ====================================== */

  .auth-form-container {
    max-width: var(--form-container-max-width);
    width: 100%;
    margin: 0 auto;
    padding: var(--space-lg);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    background: var(--card-bg);
    border: var(--border-width-thin) solid var(--card-border);
    transition:
      box-shadow var(--transition-normal),
      background var(--transition-normal);
    animation: fadeIn 0.4s ease;

    @media (max-width: 29.9375em) {
      padding: var(--space-sm) var(--space-xs);
      margin: 0 var(--space-xs);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      max-width: calc(100vw - var(--space-lg));
    }
    @media (min-width: 30em) and (max-width: 47.9375em) {
      padding: var(--space-md);
      margin: 0 var(--space-md);
      border-radius: var(--radius-lg);
      max-width: var(--container-sm);
    }
    @media (min-width: 48em) {
      padding: var(--space-xl);
      margin: 0 auto;
      max-width: var(--form-container-max-width);
    }
    @media (min-width: 64em) {
      padding: var(--space-2xl);
      max-width: calc(var(--form-container-max-width) * 1.125);
      border-radius: var(--radius-xl);
    }

    // High contrast mode support
    @media (prefers-contrast: high) {
      border: var(--border-width-enhanced) solid var(--text-primary);
      box-shadow: var(--shadow-xl);
      background: var(--bg-primary);
    }
    // Reduced motion support
    @media (prefers-reduced-motion: reduce) {
      animation: none;
      transition: none;
    }
    // Dark mode adjustments
    @media (prefers-color-scheme: dark) {
      background: var(--bg-secondary);
      border-color: var(--border-secondary);
      box-shadow: var(--card-shadow-hover);
    }
    // Focus states
    &:focus-within {
      outline: var(--focus-outline);
      outline-offset: var(--focus-ring-offset);
      box-shadow: var(--shadow-lg), var(--focus-ring);
    }
    // Hover effects
    &:hover {
      box-shadow: var(--card-shadow-hover);
      transition: box-shadow var(--transition-fast);
    }
    // Active state
    &:active {
      box-shadow: var(--shadow-md);
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @media print {
    .auth-form-container {
      box-shadow: none;
      border: var(--print-border);
      background: var(--print-bg);
      color: var(--print-text);
      animation: none;
      max-width: var(--width-full);
      margin: var(--space-md) 0;
      padding: var(--space-lg);
    }
  }

  @media (forced-colors: active) {
    .auth-form-container {
      border: var(--border-width-thick) solid ButtonBorder;
      background: ButtonFace;
      forced-color-adjust: none;
    }
  }
</style>
