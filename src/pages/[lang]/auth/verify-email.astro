---
/**
 * Email Verification Page for MelodyMind
 *
 * This page handles email verification when a user clicks on the confirmation
 * link in their email. It uses the Layout component and the EmailVerification
 * component to render the verification interface.
 *
 * The page extracts the verification token from the URL query parameters.
 * If no token is present, the user is redirected to the login page.
 */

import EmailVerification from "@components/auth/EmailVerification.astro";
import Layout from "@layouts/Layout.astro";
import { getLangFromUrl, useTranslations, getRelativeLocaleUrl } from "@utils/i18n";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const url = new URL(Astro.request.url);
const token = url.searchParams.get("token");

const loginUrl = getRelativeLocaleUrl(lang, "auth/login");

if (!token) {
  return Astro.redirect(loginUrl);
}
---

<Layout
  title={t("auth.email_verification.title")}
  description={t("auth.email_verification.description")}
>
  <EmailVerification {token} />
</Layout>
