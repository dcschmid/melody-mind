---
import Layout from "@layouts/Layout.astro";
import PageShell from "@components/Shared/PageShell.astro";
import { buildPageSeo, type StructuredData } from "@utils/seo/buildPageSeo";
import { resolvePageUrl } from "@utils/siteUrls";

const title = "Privacy Policy";
const description =
  "How we process personal data on Melody Mind Knowledge, including analytics with Fathom and AI-generated media details.";
const currentUrl = resolvePageUrl(Astro.site, "/privacy");

const breadcrumbs = [
  { name: "Home", url: resolvePageUrl(Astro.site, "/") },
  { name: title, url: currentUrl },
];

const pageSeo = buildPageSeo({
  title,
  description,
  url: currentUrl,
  contentKind: "generic",
  breadcrumbs,
  structuredData: [] as StructuredData[],
  enrichedParts: [title, description],
  fallbackKeywords: ["privacy", "data protection", "fathom analytics", "openai media"],
  keywordLimit: 24,
  maxDescription: 160,
  image: "/knowledge.png",
  publishDate: new Date(),
  modifiedDate: new Date(),
  index: true,
  follow: true,
  autoSocialImage: false,
});
---

<Layout {pageSeo} {breadcrumbs}>
  <PageShell containerClass="page-shell__container--spacious">
    <div class="legal-page">
      <header class="legal-page__header">
        <p class="legal-page__eyebrow">Privacy</p>
        <h1 class="legal-page__title">Privacy Policy</h1>
        <p class="legal-page__lead">
          This notice explains how we process personal data on Melody Mind Knowledge in
          line with EU and German data protection requirements (DSGVO/GDPR).
        </p>
      </header>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">1. Controller</h2>
        <p class="legal-page__text">Daniel Schmid</p>
        <p class="legal-page__text">Hiltenspergerstr. 78, 80796 München, Germany</p>
        <p class="legal-page__text">
          Email:
          <a class="legal-page__link" href="mailto:dcschmid@murena.io">
            dcschmid@murena.io
          </a>
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">2. Hosting & Access Logs</h2>
        <p class="legal-page__text">
          We host on Render (render.com). Render processes server logs (IP address,
          timestamp, requested URL, user agent) to ensure site stability and security.
          Legal basis: Art. 6(1)(f) GDPR (legitimate interest in secure operation). Logs
          are deleted automatically on a rolling basis. Depending on the Render region,
          data may be processed in the EU or transferred to the USA under appropriate
          safeguards (e.g., SCCs).
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">3. Analytics with Fathom</h2>
        <p class="legal-page__text">
          We use Fathom Analytics, a privacy-friendly, EU-hosted analytics service that
          does not set identifying cookies. Fathom processes anonymized page views and
          referrers. Legal basis: Art. 6(1)(f) GDPR (legitimate interest in understanding
          site usage). You can opt out via Do Not Track in your browser; Fathom respects
          DNT.
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">4. AI-Generated Content</h2>
        <p class="legal-page__text">
          Some text and images are generated or assisted by OpenAI services. No personal
          data is intentionally sent to OpenAI. If you contact us and share personal
          information, we do not use that content in AI prompts without your consent.
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">5. Contact</h2>
        <p class="legal-page__text">
          If you email us, we process your message, contact details, and metadata to
          respond. Legal basis: Art. 6(1)(b) GDPR (pre-contractual communication) or Art.
          6(1)(f) GDPR (legitimate interest in replying to inquiries). Data is kept only
          as long as needed.
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">6. Your Rights</h2>
        <p class="legal-page__text">
          You have the rights of access, rectification, erasure, restriction, objection
          (including to processing based on Art. 6(1)(f) GDPR), and data portability. You
          may also lodge a complaint with your local supervisory authority. In Bavaria,
          this is the BayLDA (Bayerisches Landesamt für Datenschutzaufsicht).
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">7. Data Retention</h2>
        <p class="legal-page__text">
          We retain personal data only as long as necessary for the stated purposes or
          legal obligations and then delete or anonymize it.
        </p>
      </section>

      <section class="panel legal-page__section">
        <h2 class="legal-page__section-title">8. Updates</h2>
        <p class="legal-page__text">
          We may update this policy to reflect legal or technical changes. Last updated:
          {new Date().toLocaleDateString("en-GB")}.
        </p>
      </section>
    </div>
  </PageShell>
</Layout>
<style>
  .panel {
    --panel-radius: 1.5rem;
    --panel-padding: 1.5rem;
    --panel-bg: color-mix(in srgb, var(--gn-bg-muted) 92%, transparent);
    --panel-border: color-mix(in srgb, var(--gn-panel-border) 85%, transparent);
    position: relative;
    border-radius: var(--panel-radius);
    background: var(--panel-bg);
    border: 2px solid var(--panel-border);
    box-shadow: var(--gn-offset-shadow);
    padding: var(--panel-padding);
  }

  .panel::after {
    content: "";
    position: absolute;
    inset: 4px;
    border: 1px solid var(--gn-panel-inner);
    border-radius: calc(var(--panel-radius) - 0.25rem);
    pointer-events: none;
  }

  .panel--compact {
    --panel-padding: 1rem;
  }

  .panel--tight {
    --panel-padding: 1.25rem;
  }

  .panel--card {
    --panel-radius: 1.25rem;
    --panel-padding: 1.25rem;
  }

  .legal-page {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .legal-page__header {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .legal-page__eyebrow {
    font-size: 0.75rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    font-weight: 600;
    color: var(--color-gn-amber-300);
  }

  .legal-page__title {
    font-size: 2rem;
    font-weight: 600;
    color: var(--gn-ink);
    margin: 0;
  }

  @media (min-width: 640px) {
    .legal-page__title {
      font-size: 2.3rem;
    }
  }

  .legal-page__lead {
    font-size: 1rem;
    color: var(--gn-ink-muted);
    margin: 0;
  }

  .legal-page__section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .legal-page__section-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--gn-ink);
    margin: 0;
  }

  .legal-page__text {
    margin: 0;
    color: var(--gn-ink-muted);
    line-height: 1.6;
  }

  .legal-page__link {
    color: var(--color-gn-amber-300);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .legal-page__link:hover {
    color: var(--color-gn-amber-200);
  }
</style>
