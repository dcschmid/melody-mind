---
import { Icon } from "astro-icon/components";

interface Crumb {
  name: string;
  url?: string;
}

interface Props {
  items: Crumb[];
  ariaLabel?: string;
}

const { items = [], ariaLabel = "Breadcrumb" } = Astro.props;
const normalized = Array.isArray(items) ? items.filter(Boolean) : [];
---

{
  normalized.length > 0 && (
    <nav aria-label={ariaLabel} class="breadcrumbs">
      <ol class="breadcrumbs__list">
        {normalized.map((crumb, index) => {
          const isLast = index === normalized.length - 1;
          return (
            <li class="breadcrumbs__item">
              {index > 0 && (
                <span class="breadcrumbs__divider" aria-hidden="true">
                  /
                </span>
              )}
              {isLast || !crumb.url ? (
                <span
                  class="breadcrumbs__current"
                  aria-current={isLast ? "page" : undefined}
                >
                  {crumb.name}
                </span>
              ) : (
                <a href={crumb.url} class="breadcrumbs__link">
                  {index === 0 && (
                    <Icon name="home" class="breadcrumbs__link-icon" aria-hidden="true" />
                  )}
                  <span class="breadcrumbs__link-text">{crumb.name}</span>
                </a>
              )}
            </li>
          );
        })}
      </ol>
    </nav>
  )
}
