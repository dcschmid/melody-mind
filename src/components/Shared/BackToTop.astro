---
/**
 * @component BackToTop
 * @description Reusable back-to-top button component with optimized scroll behavior.
 * Provides consistent styling, accessibility, and performance across all pages.
 *
 * @example
 * ```astro
 * <BackToTop lang="en" />
 * <BackToTop lang="de" className="custom-position" />
 * ```
 */

import { Icon } from "astro-icon/components";
import { useTranslations } from "@utils/i18n";

/**
 * Props interface for the BackToTop component
 */
interface Props {
  /** Language code for internationalization */
  lang: string;
  /** Additional CSS class for custom positioning or styling */
  className?: string;
  /** Custom aria-label (overrides default translation) */
  ariaLabel?: string;
  /** Custom scroll threshold in pixels (uses CSS variable if not provided) */
  scrollThreshold?: number;
}

const { lang = "en", className = "", ariaLabel, scrollThreshold } = Astro.props;
const t = useTranslations(lang);

// Use custom aria-label or fallback to translation
const buttonAriaLabel = ariaLabel || t("common.back.to.top");
const screenReaderText = t("common.back.to.top");
---

<button
  id="back-to-top"
  class={`back-to-top ${className}`.trim()}
  aria-label={buttonAriaLabel}
  type="button"
  style="display: none;"
  data-scroll-threshold={scrollThreshold}
>
  <Icon name="arrow-up" class="back-to-top__icon" aria-hidden="true" />
  <span class="back-to-top__sr">{screenReaderText}</span>
</button>
<style>
  @media screen and (prefers-reduced-motion: reduce) {
    .back-to-top {
      position: fixed;
      inset-block-end: 1rem;
      inset-inline-end: 1rem;
      z-index: 30;
      min-inline-size: 48px;
      min-block-size: 48px;
      padding: 0.9rem;
      color: var(--color-gn-soot-950);
      cursor: pointer;
      background: var(--color-gn-amber-500);
      border: 2px solid var(--gn-panel-border);
      border-radius: 999px;
      box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.8);
      transition: none;
    }
  }

  .back-to-top {
    position: fixed;
    inset-block-end: 1rem;
    inset-inline-end: 1rem;
    z-index: 30;
    min-inline-size: 48px;
    min-block-size: 48px;
    padding: 0.9rem;
    color: var(--color-gn-soot-950);
    cursor: pointer;
    background: var(--color-gn-amber-500);
    border: 2px solid var(--gn-panel-border);
    border-radius: 999px;
    box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.8);
    transition:
      transform var(--transition-fast),
      box-shadow var(--transition-fast),
      background-color var(--transition-fast);
  }

  .back-to-top:hover,
  .back-to-top:focus {
    background: var(--color-gn-amber-400);
    box-shadow: 6px 6px 0 rgba(0, 0, 0, 0.85);
    transform: translateY(-4px);
  }

  .back-to-top:active {
    box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.85);
    transform: translateY(0);
  }

  .back-to-top:focus-visible {
    outline: 3px solid var(--color-gn-amber-300);
    outline-offset: 2px;
  }

  .back-to-top__icon {
    display: block;
    inline-size: 1.5rem;
    block-size: 1.5rem;
  }

  @media (width >= 768px) {
    .back-to-top__icon {
      inline-size: 2rem;
      block-size: 2rem;
    }
  }

  .back-to-top__sr {
    position: absolute;
    inline-size: var(--sr-only-width);
    block-size: var(--sr-only-height);
    margin: var(--sr-only-margin);
    overflow: hidden;
    white-space: nowrap;
    border: 0;
    clip-path: var(--sr-only-clip-path);
  }
</style>
