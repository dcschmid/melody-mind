---
import { For } from "@astropub/flow";
import Arrows from "../Round/Arrows.astro";
import { Picture } from "astro:assets";

const {
  randomizedCoverflowData,
  upText = "",
  downText = "",
  dataCategory = "",
  dataSolution,
  dataRound = "",
} = Astro.props;
---


<div
  class="coverFlowRoot"
  data-category={dataCategory}
  data-solution={JSON.stringify(dataSolution)}
  data-round={dataRound.replace("#", "")}
>
<div class="smallText">{upText}</div>

  <div class="coverflow">
    <For of={randomizedCoverflowData}>
      {
        (item: any) => (
          <div
            class="cover"
            data-band={item.band}
            data-album={item.album}
            data-data={
              dataRound === "round-one" ? item.dataYear : dataRound === "round-two" ? item.dataSales : item.dataLength
            }
            data-cover-source={item.coverSrc}
          >
            <Picture src={item.coverSrc} width={130} height={130} formats={["avif", "webp"]} alt="" />
            <audio id={`audio-${item.band}`} src={item.audioSrc} preload="none" />
          </div>
        )
      }
    </For>

    <Arrows />
  </div>
  <div class="smallText">{downText}</div>

</div>


<style>
  .smallText {
    width: auto;
    display: inline-flex;
    margin: var(--spacing-s) 0;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-xxs);
    font-size: 16px;
    font-style: normal;
    font-weight: 400;
  }

  .coverFlowRoot {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
  }

  .coverflow {
    display: flex;
    flex-wrap: wrap;
    padding: var(--spacing-md);
    align-items: flex-start;
    justify-content: center;
    gap: var(--spacing-md);

    @media screen and (min-width: 360px) {
        padding: var(--spacing-1) var(--spacing-xl) var(--spacing-15) var(--spacing-xl);
    }
  }

  .cover {
    width: 120px;
    height: 120px;


    @media screen and (min-width: 385px) {
        width: 140px;
        height: 140px;
    }

    @media screen and (min-width: 425px) {
        width: 160px;
        height: 160px;
    }

    @media screen and (min-width: 475px) {
        width: 180px;
        height: 180px;
    }

  }

  .cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .cover.selected {
    border-radius: var(--radius-radius-rounded);
    border: 4px solid var(--primary-color);
  }

  .cover:nth-child(2) {
    top: 0;
    left: 0;
  }

  .cover:nth-child(2) {
    margin-top: 4rem;
  }

  .cover:nth-child(3) {
    margin-top: -2rem;
  }

  .cover:nth-child(4) {
    margin-top: 2rem;
  }
</style>
