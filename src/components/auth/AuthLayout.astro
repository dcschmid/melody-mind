---
/**
 * AuthLayout Component für MelodyMind
 *
 * Diese Komponente stellt ein gemeinsames Layout für alle Authentifizierungsseiten bereit.
 * Sie enthält die SEO-Komponente, ein einheitliches Design und Zugänglichkeitsfunktionen.
 * Das Layout ist nach WCAG AAA Standards optimiert.
 *
 * @component
 * @example
 * ```astro
 * <AuthLayout title="Anmelden">
 *   <LoginForm />
 * </AuthLayout>
 * ```
 */
import { getLangFromUrl, useTranslations } from "@utils/i18n";
import SEO from "@components/SEO.astro";
import SkipLink from "@components/Shared/SkipLink.astro";
import Footer from "@components/Footer.astro";
import LanguagePicker from "@components/LanguagePicker.astro";

interface Props {
  /** Seitentitel - wird für SEO und Browser-Tab verwendet */
  title: string;
  /** Seitenbeschreibung - wichtig für SEO */
  description?: string;
}

const { title, description } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<!doctype html>
<html lang={lang} class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <SEO title={title} description={description} />
    <link rel="stylesheet" href="/styles/auth.css" />
  </head>
  <body class="h-full bg-zinc-900 text-white">
    <SkipLink />

    <div class="flex min-h-full flex-col">
      <header
        class="py-4 px-6 flex justify-between items-center border-b border-zinc-800"
      >
        <a
          href={`/${lang}`}
          class="flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-offset-2 focus:ring-offset-zinc-900 rounded-md p-1"
        >
          <img
            src="/melody-mind.png"
            alt="Melody Mind Logo"
            width="40"
            height="40"
          />
          <span class="text-xl font-bold">Melody Mind</span>
        </a>
        <LanguagePicker />
      </header>

      <main
        id="main-content"
        class="flex-grow flex items-center justify-center p-6"
      >
        <div class="w-full max-w-md">
          <slot />
        </div>
      </main>

      <Footer />
    </div>

    <script>
      // Verbesserte Fokus-Verwaltung für Tastaturnavigation
      document.addEventListener("keydown", (e) => {
        if (e.key === "Tab") {
          document.body.classList.add("user-is-tabbing");
        }
      });

      document.addEventListener("mousedown", () => {
        document.body.classList.remove("user-is-tabbing");
      });
    </script>
  </body>
</html>

<style>
  /* Verbesserte Fokus-Stile für Tastaturnavigation */
  :global(.user-is-tabbing *:focus) {
    outline: 3px solid #f0abfc !important;
    outline-offset: 3px !important;
  }

  /* Verbesserte Kontrastverhältnisse für WCAG AAA */
  :global(body) {
    color: #ffffff;
    background-color: #18181b;
  }

  :global(a) {
    color: #d8b4fe;
    text-decoration: underline;
    text-underline-offset: 0.2em;
  }

  :global(a:hover) {
    color: #f0abfc;
    text-decoration: underline;
  }

  :global(a:focus) {
    outline: 3px solid #f0abfc;
    outline-offset: 3px;
  }
</style>
